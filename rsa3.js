function download(e,n,t){var a=new Blob([e],{type:t});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,n);else{var o=document.createElement("a"),r=URL.createObjectURL(a);o.href=r,o.download=n,document.body.appendChild(o),o.click(),setTimeout(function(){document.body.removeChild(o),window.URL.revokeObjectURL(r)},0)}}function do_hash(){do_genrsa();var e=new RSAKey;e.setPublic(document.rsatest.n.value,document.rsatest.e.value);for(var n="",t=parseInt(Math.random().toString().slice(0,5).replace(".","")),a=0;a<t;a++){var o=parseInt((1e5*Math.random()).toString().slice(0,3));o>=33&&o<=126&&(n=n.concat(String.fromCharCode(o)))}res=e.encrypt(n),res&&download((linebrk(res,64)+document.rsatest.n.value).replace(new RegExp("\\r?\\n","g"),""),"SynCryptHash.sc",Text)}function do_genrsa(){var e=new RSAKey,n=document.rsatest;e.generate(parseInt(2048),n.e.value),n.n.value=linebrk(e.n.toString(16),64),n.d.value=linebrk(e.d.toString(16),64)}document.getElementById("hash").onclick=function(){do_hash()}